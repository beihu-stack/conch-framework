## 数据倾斜

数据分片后，容易产生数据倾斜

- **数据量倾斜**：在某些情况下，实例上的数据分布不均衡，某个实例上的数据特别多。
- **数据访问倾斜**：虽然每个集群实例上的数据量相差不大，但是某个实例上的数据是热点数据，被访问得非常频繁。



### 数据量倾斜



##### Redis

- BigKey导致倾斜
  - 避免业务使用bigkey
  - 将bigkey按业务场景进行拆分，均摊到不同的Slot中
- Slot分片不均匀
- Hash Tag：针对hash的键值对的值的key进行CRC16，保证相同业务或场景的数据落到相同的slot
  - 带来的问题就是会产生数据倾斜，我们需要将  范围查询、事务执行等需求 同 数据倾斜带来的访问压力及实例稳定性方面进行取舍
  - 建议优先以解决数据倾斜为第一目标，保证系统的稳定





### 数据访问倾斜

新闻、热点、促销商品等



##### Redis

- 和数据量倾斜不同，热点数据通常是一个或几个数据，所以，直接重新分配 Slot 并不能解决热点数据的问题。
- 热点数据以服务只读操作为主：
  - 热点数据多副本：将数据加上随机前缀，存储多份到redis的不同slot上
  - 冷热分离？ - 主要针对历史数据量大的情况

- 热点数据以服务写多操作为主：
  - 增加很多副本会加重主从数据同步的压力
  - 依据业务，增加实例资源