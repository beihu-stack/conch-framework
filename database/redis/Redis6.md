## Redis6

##### DPDK知识补充

英语：Data Plane Development Kit，是一组快速处理数据包 的开发平台及接口。运行于Intel X86 与arm平台上（最新版本也开始支持PowerPC。该平台采用BSD许可证发布。

在X86结构中，处理数据包的传统方式是CPU中断方式，即网卡驱动接收到数据包后通过中断通知CPU处理，然后由CPU拷贝数据并交给协议栈。在数据量大时，这种方式会产生大量CPU中断，导致CPU无法运行其他程序。而DPDK则采用轮询 方式实现数据包处理过程：DPDK重载了网卡驱动，该驱动在收到数据包后不中断通知CPU，而是将数据包通过零拷贝技术存入内存，这时应用层程序就可以通过DPDK提供的接口，直接从内存读取数据包。这种处理方式节省了CPU中断时间、内存拷贝时间，并向应用层提供了简单易行且高效的数据包处理方式，使得网络应用的开发更加方便。但同时，由于需要重载网卡驱动，因此该开发包目前只能用在部分采用Intel网络处理芯片的网卡中。

使用 用户态网络协议栈 取代 内核态网络协议栈



### 多线程特性

Redis6.0的多线程 仅针对 **处理网络请求**，对与读写命令，Redis依旧使用单线程来处理

默认是关闭的：redis.conf

```shell
io-threads-do-reads yes
# 线程数需小于CPU核数
io-threads 6
```



### 客户端缓存

- 普通模式
  - 只会在每次读取后缓存，当数据被修改后，服务端会发送一个invalidate消息给到客户端，如果后续该数据再被修改，则无法收到invalidate消息，除非再次执行对应key的查询后才会触发服务端对该key的监控
- 广播模式
  - 客户端通过注册自己观察的key或者 key前缀，只要数据发生变化，服务端则会广播通知所有订阅了消息的客户端



### NVM

Non-Volatile Memory 新型非易失存储

高性能：读延迟相对DRAM有些延迟

大容量：密度大

数据可持久化





### TODO redis的线程模型